<p>todo-list works!</p>
<section class="space-y-5">
	@if (stats$ | async; as stats) {
		<header class="flex flex-col gap-2 rounded-xl border border-border bg-muted/40 p-4 shadow-card sm:flex-row sm:items-center sm:justify-between">
			<div>
				<h2 class="text-lg font-semibold text-foreground">Today&apos;s focus</h2>
				<p class="text-sm text-muted-foreground">
					{{ stats.active }} active · {{ stats.completed }} completed · {{ stats.total }} total
				</p>
			</div>
			@if (stats.completed > 0) {
				<button
					type="button"
					class="inline-flex items-center gap-2 rounded-lg border border-border bg-background px-4 py-2 text-sm font-medium text-foreground transition hover:bg-muted"
					(click)="clearCompleted()"
				>
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-4 w-4">
						<path
							fill-rule="evenodd"
							d="M7.22 10.22a.75.75 0 0 1 1.06 0L10 11.94l1.72-1.72a.75.75 0 1 1 1.06 1.06L11.06 13l1.72 1.72a.75.75 0 1 1-1.06 1.06L10 14.06l-1.72 1.72a.75.75 0 0 1-1.06-1.06L8.94 13l-1.72-1.72a.75.75 0 0 1 0-1.06Z"
							clip-rule="evenodd"
						/>
					</svg>
					Clear completed
				</button>
			}
		</header>
	}

	@if (todos$ | async; as todos) {
		@if (todos.length > 0) {
			<ul class="space-y-3" [@listAnimation]="todos">
		@for (todo of todos; track todo.id) {
					<li class="todo-item group flex items-start justify-between gap-4 rounded-xl border border-border bg-background p-4 shadow-card transition hover:border-primary/50" [@itemHighlight]>
						<div class="flex flex-1 items-start gap-4">
							<button
								type="button"
								(click)="toggle(todo)"
								class="mt-1 flex h-5 w-5 flex-shrink-0 items-center justify-center rounded-full border border-border transition group-hover:border-primary/50"
								[class.bg-primary]="todo.completed"
								[class.text-primary-foreground]="todo.completed"
								[attr.aria-pressed]="todo.completed"
								aria-label="Toggle completion"
							>
								@if (todo.completed) {
									<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-3 w-3 text-primary-foreground">
										<path
											fill-rule="evenodd"
											d="M16.704 5.29a1 1 0 0 1 0 1.42l-6.364 6.364a1 1 0 0 1-1.414 0L4.7 8.848a1 1 0 1 1 1.414-1.414l3.115 3.115 5.657-5.658a1 1 0 0 1 1.818.4Z"
											clip-rule="evenodd"
										/>
									</svg>
								}
							</button>
							<div class="flex-1 space-y-2">
								<div class="flex flex-wrap items-start gap-2">
									<p
										class="text-sm font-medium text-foreground"
										[class.line-through]="todo.completed"
										[class.text-muted-foreground]="todo.completed"
									>
										{{ todo.title }}
									</p>
									@if (todo.dueDate) {
										<span class="inline-flex items-center rounded-full bg-primary/10 px-2 py-1 text-[10px] font-semibold uppercase tracking-wide text-primary">
											Due <time [attr.datetime]="todo.dueDate">{{ todo.dueDate | date: 'MMM d' }}</time>
										</span>
									}
								</div>
								@if (todo.description) {
									<p class="text-sm leading-relaxed text-muted-foreground">{{ todo.description }}</p>
								}
								<div class="flex flex-wrap items-center gap-3 text-xs text-muted-foreground">
									<span>Created {{ todo.createdAt | date: 'MMM d, y • h:mm a' }}</span>
									@if (todo.updatedAt !== todo.createdAt) {
										<span>Updated {{ todo.updatedAt | date: 'MMM d, y • h:mm a' }}</span>
									}
								</div>
							</div>
						</div>
						<div class="flex flex-shrink-0 items-center gap-2 opacity-0 transition group-hover:opacity-100">
							<button
								type="button"
								class="inline-flex items-center rounded-lg border border-border bg-background px-3 py-1.5 text-xs font-semibold text-foreground transition hover:border-primary/50 hover:text-primary"
								(click)="requestEdit(todo)"
							>
								Edit
							</button>
							<button
								type="button"
								class="inline-flex items-center rounded-lg border border-transparent bg-red-500/10 px-3 py-1.5 text-xs font-semibold text-red-600 transition hover:bg-red-500/20"
								(click)="remove(todo)"
							>
								Delete
							</button>
						</div>
					</li>
				}
			</ul>
		} @else {
			<div class="flex flex-col items-center justify-center rounded-xl border border-dashed border-border bg-muted/30 p-10 text-center">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="h-10 w-10 text-muted-foreground">
					<path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-7 4h8M8.5 4l.77-1.54A1 1 0 0 1 10.18 2h3.64a1 1 0 0 1 .91.59L15.5 4M4 6h16m-1 0-.4 12.01A2 2 0 0 1 16.61 20H7.39a2 2 0 0 1-1.99-1.99L5 6" />
				</svg>
				<h3 class="mt-4 text-base font-semibold text-foreground">Nothing scheduled yet</h3>
				<p class="mt-2 max-w-sm text-sm text-muted-foreground">
					Add a task to build momentum. Keep them short, actionable, and celebrate progress as you go.
				</p>
			</div>
		}
	}
</section>
